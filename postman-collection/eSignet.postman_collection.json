{
	"info": {
		"_postman_id": "3267907a-75db-4d3c-a42e-89050178c6f4",
		"name": "eSignet",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "20579541",
		"_collection_link": "https://mosip-idp.postman.co/workspace/MOSIP-Team-Workspace~76ac5ada-d630-4817-8d7b-25f499b093d4/collection/20579541-3267907a-75db-4d3c-a42e-89050178c6f4?action=share&source=collection_link&creator=20579541"
	},
	"item": [
		{
			"name": "OIDC Client Mgmt",
			"item": [
				{
					"name": "MOSIP",
					"item": [
						{
							"name": "MOSIP PMS Authentication",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var jsonData = JSON.parse(responseBody);",
											"var data = jsonData.response.token;",
											"console.log(data);",
											"pm.environment.set(\"authtoken\",data);"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\r\n  \"id\": \"string\",\r\n  \"version\": \"string\",\r\n  \"requesttime\": \"{{$isoTimestamp}}\",\r\n  \"metadata\": {},\r\n  \"request\": {\r\n    \"appId\": \"partner\",\r\n    \"clientId\": \"mosip-pms-client\",\r\n    \"secretKey\": \"{{mosip_pms_client_secret}}\"\r\n  }\r\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{internal_url}}/v1/authmanager/authenticate/clientidsecretkey",
									"host": [
										"{{internal_url}}"
									],
									"path": [
										"v1",
										"authmanager",
										"authenticate",
										"clientidsecretkey"
									]
								}
							},
							"response": []
						},
						{
							"name": "Create OIDC Client in MOSIP",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"",
											"eval(pm.globals.get('pmlib_code'))",
											"keyPair = pmlib.rs.KEYUTIL.generateKeypair(\"RSA\", 2048);",
											"jwkPrivateKey = pmlib.rs.KEYUTIL.getJWK(keyPair.prvKeyObj);",
											"jwkPublicKey  = pmlib.rs.KEYUTIL.getJWK(keyPair.pubKeyObj);",
											"jwkPublicKey[\"alg\"] = \"RS256\";",
											"jwkPublicKey[\"use\"] = \"sig\";",
											"",
											"pm.environment.set(\"client_public_key\", JSON.stringify(jwkPublicKey))",
											"pm.environment.set(\"client_private_key\", JSON.stringify(jwkPrivateKey));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"var jsonData = JSON.parse(responseBody);",
											"var clientId = jsonData.response.clientId;",
											"console.log(clientId);",
											"pm.environment.set(\"client_id\",clientId);",
											"pm.environment.set(\"partner_api_key\",clientId);",
											"",
											"pm.test(\"Validate status\", function () {",
											"    var jsonData = pm.response.json();",
											"    pm.expect(jsonData.response.status).to.eql(\"ACTIVE\");",
											"});"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\r\n  \"id\": \"string\",\r\n  \"version\": \"string\",\r\n  \"requesttime\": \"{{$isoTimestamp}}\",\r\n  \"metadata\": {},\r\n  \"request\": {\r\n    \"name\": \"{{$randomCompanyName}}\",\r\n    \"policyId\": \"26123\",\r\n    \"publicKey\": {{client_public_key}},\r\n    \"authPartnerId\": {{relaying_party_id}},\r\n    \"logoUri\": \"{{$randomImageUrl}}\",\r\n    \"redirectUris\": [\r\n      \"{{redirection_url}}\"\r\n    ],\r\n    \"grantTypes\": [\r\n      \"authorization_code\"\r\n    ],\r\n    \"clientAuthMethods\": [\r\n      \"private_key_jwt\"\r\n    ]\r\n  }\r\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{internal_url}}/v1/partnermanager/oidc/client",
									"host": [
										"{{internal_url}}"
									],
									"path": [
										"v1",
										"partnermanager",
										"oidc",
										"client"
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "Mock",
					"item": [
						{
							"name": "Get Auth token",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var jsonData = JSON.parse(pm.response.text());",
											"var data = jsonData.access_token;",
											"console.log(data);",
											"pm.environment.set(\"authtoken\",data);"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "client_secret",
											"value": "ysd1exB4FXsZebbA",
											"type": "text"
										},
										{
											"key": "client_id",
											"value": "mosip-pms-client",
											"type": "text"
										},
										{
											"key": "grant_type",
											"value": "client_credentials",
											"type": "text"
										}
									]
								},
								"url": {
									"raw": "{{iam_url}}/auth/realms/mosip/protocol/openid-connect/token",
									"host": [
										"{{iam_url}}"
									],
									"path": [
										"auth",
										"realms",
										"mosip",
										"protocol",
										"openid-connect",
										"token"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get CSRF token",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var token = pm.cookies.get(\"XSRF-TOKEN\")",
											"pm.environment.set(\"csrf_token\", token);"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{url}}/v1/esignet/csrf/token",
									"host": [
										"{{url}}"
									],
									"path": [
										"v1",
										"esignet",
										"csrf",
										"token"
									]
								}
							},
							"response": []
						},
						{
							"name": "Create OIDC client",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"eval(pm.environment.get('pmlib_code'))",
											"kp = pmlib.rs.KEYUTIL.generateKeypair(\"RSA\", 2048);",
											"privateKey_jwk = pmlib.rs.KEYUTIL.getJWK(kp.prvKeyObj);",
											"publicKey_jwk = pmlib.rs.KEYUTIL.getJWK(kp.pubKeyObj);",
											"",
											"// Get the public key in PEM format",
											"const publicKeyPem = pmlib.rs.KEYUTIL.getPEM(kp.pubKeyObj, \"PKCS8PUB\");",
											"// Convert the PEM format to a simple Base64 string (removing PEM headers)",
											"const publicKeyBase64 = publicKeyPem.replace(/-----BEGIN PUBLIC KEY-----|-----END PUBLIC KEY-----|\\n/g, '');",
											"let updatedStr = publicKeyBase64.replace(/\\//g, \"_\");",
											"pm.environment.set(\"client_id\", updatedStr.substring(2, 50));",
											"",
											"// Log the result to Postman's console (option);",
											"pm.environment.set(\"client_private_key\", JSON.stringify(privateKey_jwk));",
											"pm.environment.set(\"client_public_key\", JSON.stringify(publicKey_jwk));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{authtoken}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "X-XSRF-TOKEN",
										"value": "{{csrf_token}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{    \n    \"requestTime\": \"{{$isoTimestamp}}\",\n    \"request\": {\n        \"clientId\": \"{{client_id}}\",\n        \"clientName\": \"{{$randomCompanyName}}\",\n        \"publicKey\": {{client_public_key}},\n        \"relyingPartyId\": \"mock-relying-party-id\",\n        \"userClaims\": [\n            \"name\",\n            \"email\",\n            \"gender\",\n            \"phone_number\",\n            \"picture\",\n            \"birthdate\"\n        ],\n        \"authContextRefs\": [\n            \"mosip:idp:acr:generated-code\",\n            \"mosip:idp:acr:password\",\n            \"mosip:idp:acr:linked-wallet\"\n        ],\n        \"logoUri\": \"{{$randomImageUrl}}\",\n        \"redirectUris\": [\n             \"{{redirection_url}}\",\n             \"io.mosip.residentapp://oauth\",\n             \"http://localhost:3000/**\",\n             \"http://localhost:5000/registration/*\"\n        ],\n        \"grantTypes\": [\n            \"authorization_code\"\n        ],\n        \"clientAuthMethods\": [\n            \"private_key_jwt\"\n        ],\n        \"additionalConfig\": {\n            \"userinfo_response_type\": \"JWS\",\n            \"purpose\": {\n                \"type\": \"verify\",\n                \"title\": {\n                    \"@none\": \"title\"\n                },\n                \"subTitle\": {\n                    \"@none\": \"subtitle\"\n                }\n            },\n            \"signup_banner_required\": true,\n            \"forgot_pwd_link_required\": true,\n            \"consent_expire_in_mins\": 20\n        }\n    }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{url}}/v1/esignet/client-mgmt/client",
									"host": [
										"{{url}}"
									],
									"path": [
										"v1",
										"esignet",
										"client-mgmt",
										"client"
									]
								}
							},
							"response": []
						},
						{
							"name": "Update OIDC client",
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "PUT",
								"header": [
									{
										"key": "X-XSRF-TOKEN",
										"value": "{{csrf_token}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"requestTime\": \"{{$isoTimestamp}}\",\n    \"request\": {\n        \"logoUri\": \"{{$randomImageUrl}}\",\n        \"redirectUris\": [\n               \"{{redirection_url}}\",\n             \"io.mosip.residentapp://oauth\",\n             \"http://localhost:3000/**\",\n             \"http://localhost:5000/registration/*\"\n        ],\n        \"userClaims\": [\n            \"name\",\n            \"email\",\n            \"gender\",\n            \"phone_number\",\n            \"birthdate\",\n            \"picture\",\n            \"address\"\n        ],\n        \"authContextRefs\": [\n            \"mosip:idp:acr:generated-code\",\n            \"mosip:idp:acr:password\",\n            \"mosip:idp:acr:linked-wallet\",\n            \"mosip:idp:acr:biometrics\",\n            \"mosip:idp:acr:static-code\"\n        ],\n        \"status\": \"ACTIVE\",\n        \"grantTypes\": [\n            \"authorization_code\"\n        ],\n        \"clientName\": \"{{$randomCompanyName}}\",\n        \"clientAuthMethods\": [\n            \"private_key_jwt\"\n        ],\n        \"additionalConfig\": {\n            \"userinfo_response_type\": \"JWS\",\n            \"purpose\": {\n                \"type\": \"verify\",\n                \"title\": {\n                    \"@none\": \"title\"\n                },\n                \"subTitle\": {\n                    \"@none\": \"subtitle\"\n                }\n            },\n            \"signup_banner_required\": true,\n            \"forgot_pwd_link_required\": true,\n            \"consent_expire_in_mins\": 20\n        }\n    }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{url}}/v1/esignet/client-mgmt/client/{{client_id}}",
									"host": [
										"{{url}}"
									],
									"path": [
										"v1",
										"esignet",
										"client-mgmt",
										"client",
										"{{client_id}}"
									]
								}
							},
							"response": []
						}
					]
				}
			]
		},
		{
			"name": "User Mgmt",
			"item": [
				{
					"name": "Mock",
					"item": [
						{
							"name": "Create User",
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"requestTime\": \"{{$isoTimestamp}}\",\n    \"request\": {\n        \"individualId\": \"{{individual_id}}\",\n        \"pin\": \"545411\",\n        \"email\": \"siddhartha.km@gmail.com\",\n        \"phone\": \"+919427357934\",\n        \"fullName\": [\n            {\n                \"language\": \"fra\",\n                \"value\": \"Siddharth K Mansour\"\n            },\n            {\n                \"language\": \"ara\",\n                \"value\": \"تتگلدكنسَزقهِقِفل دسييسيكدكنوڤو\"\n            },\n            {\n                \"language\": \"eng\",\n                \"value\": \"Siddharth K Mansour\"\n            }\n        ],\n        \"nickName\": [\n            {\n                \"language\": \"fra\",\n                \"value\": \"Siddharth K Mansour\"\n            },\n            {\n                \"language\": \"ara\",\n                \"value\": \"تتگلدكنسَزقهِقِفل دسييسيكدكنوڤو\"\n            },\n            {\n                \"language\": \"eng\",\n                \"value\": \"Siddharth K Mansour\"\n            }\n        ],\n        \"preferredUsername\": [\n            {\n                \"language\": \"fra\",\n                \"value\": \"Siddharth K Mansour\"\n            },\n            {\n                \"language\": \"ara\",\n                \"value\": \"تتگلدكنسَزقهِقِفل دسييسيكدكنوڤو\"\n            },\n            {\n                \"language\": \"eng\",\n                \"value\": \"Siddharth K Mansour\"\n            }\n        ],\n        \"givenName\": [\n            {\n                \"language\": \"fra\",\n                \"value\": \"Siddharth K Mansour\"\n            },\n            {\n                \"language\": \"ara\",\n                \"value\": \"تتگلدكنسَزقهِقِفل دسييسيكدكنوڤو\"\n            },\n            {\n                \"language\": \"eng\",\n                \"value\": \"Siddharth K Mansour\"\n            }\n        ],\n        \"middleName\": [\n            {\n                \"language\": \"fra\",\n                \"value\": \"Siddharth K Mansour\"\n            },\n            {\n                \"language\": \"ara\",\n                \"value\": \"تتگلدكنسَزقهِقِفل دسييسيكدكنوڤو\"\n            },\n            {\n                \"language\": \"eng\",\n                \"value\": \"Siddharth K Mansour\"\n            }\n        ],\n        \"familyName\": [\n            {\n                \"language\": \"fra\",\n                \"value\": \"Mansour\"\n            },\n            {\n                \"language\": \"ara\",\n                \"value\": \"تتگلدكنسَزقهِقِفل\"\n            },\n            {\n                \"language\": \"eng\",\n                \"value\": \"Mansour\"\n            }\n        ],\n        \"gender\": [\n            {\n                \"language\": \"eng\",\n                \"value\": \"Male\"\n            },\n            {\n                \"language\": \"fra\",\n                \"value\": \"Mâle\"\n            },\n            {\n                \"language\": \"ara\",\n                \"value\": \"ذكر\"\n            }\n        ],\n        \"dateOfBirth\": \"1987/11/25\",\n        \"streetAddress\": [\n            {\n                \"language\": \"eng\",\n                \"value\": \"Slung\"\n            }\n        ],\n        \"locality\": [\n            {\n                \"language\": \"eng\",\n                \"value\": \"yuanwee\"\n            }\n        ],\n        \"password\": \"Mosip@123\",\n        \"preferredLang\": \"eng\",\n        \"locale\": \"en\",\n        \"region\": [\n            {\n                \"language\": \"eng\",\n                \"value\": \"yuanwee\"\n            }\n        ],\n        \"zoneInfo\": \"test zone\",\n        \"postalCode\": \"45009\",\n        \"country\": [\n            {\n                \"language\": \"fra\",\n                \"value\": \"CMâttye\"\n            },\n            {\n                \"language\": \"ara\",\n                \"value\": \"دسييسيكدك\"\n            },\n            {\n                \"language\": \"eng\",\n                \"value\": \"Cmattey\"\n            }\n        ],\n        \"encodedPhoto\": \"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAIBAQEBAQIBAQECAgICAgQDAgICAgUEBAMEBgUGBgYFBgYGBwkIBgcJBwYGCAsICQoKCgoKBggLDAsKDAkKCgr/2wBDAQICAgICAgUDAwUKBwYHCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgr/wAARCACBAH0DASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD8afAXw+8B6trH9lat4djuUkulDSGV0YDPPKsK9Mvfg98AvB3xIs9G1P4bpqOmXJ4WTWbyHau4DA8uYep712nxf/Zw/wCFRfFCVNAsV+yTzkwLjHljIAAA7V55451q4v8AxHALtXU20WYwwwecMK4cPivaaHbXw3sq3sz6csf2Kf2Ftaso9UtvgBbqkq7kRfEup4I/8Ca19I/Yh/YNRB9q/ZrtnIPzE+K9WBI7j/j64z7Vm/A7xBear8OdJuZ2J/0Uc59zXeQ3ZZtwbvWybT3OJRTR8Kf8FG/hj8Evhb8btJ8MfA/4eReGNMuPCUV3c2EGp3V2GuDd3abt9zJI+fLji4zj2r54e3TGVNfRH/BTqUQftD6RIzcP4QhOfc3V0P6CvnhGbBXNb7oerGJERnJpJNxY4qbJI5PeoGkkMu1T3pqyFa71G7GZgDDvLMAF9TXvPwk+DHgU+CxqHjixSe5vdssMZHMCYIZcggj1rxnRYp31OAQwpJIsqsEc4Bwa9xPiuz0XRZ5dULJc3ELMqRjcsfBGAfSvPx1SqopQep62X0qd+dnN2nwn8GeKvibJ4S8L6XHHaRykPNNPIwVRjuWPYmv0Y/Yn/wCCDnwc+K9vZ+NPizDqA0i6QSQWazyxPeqf44h5kREYIIOMn3rwP/gkB+zRbfGv4qy/ELxRA1zpNjc7pLOdP3U7bQw3Ht0xxX7y/BnQ7a0sIZcCQuoMajlUHopHUV8vnGZYylWVOnUPt8pyfBuh9YnTPmux/wCDdL/gl9LppnPwJuzIMYb/AIS3WB+gvMV45+0P/wAG437NC6Hd6l8EPCU2nXK5+z20mp3M65IOP9fM/Nfq7pfmR23kvxVLxTbN9hlwOMUqmIzFUeb2hVHLcteI0gfyxftZfsC+PP2X/Fj+H/F3g84Qtul2McYOOcDivEprLwxpz+RceHrZm9Wz/jX9LX7WP7MPw8+P+gXGi+K9DtzIyHZcsuWB59Tivwb/AG8P2VpvgH8c77wdp+nNLZiWT7JIiZygIHbjvXTlOd1KkvZ1dTjzTIcPSfPTPtb9u3wymj6imo2zqkkc6gOrD7m/5ua+OPjXZ6Xf6wutaRMjB1IfYQRkmvsH9urWbuG7m0HWdPCq0mElbOCucHnpXxJNpiN4tn8PWl3ILdZgYo9vBHY4/OujKWuVX2PFzumvban1J+zN4Z1O8+FGk4ty2bVegJ7mvVNN+GPii9lCWekSnPrGR/SvRP8Agl98H7P4gLo/hjUIMxpZEkFc8jmv1D+Hv7GXwx0mNbi90SKWRSPvRf8A169+lhpVHd6HydSr7LRI/mF/4K1eE9S8NftF6Fp2q25hlPgq3cxnqP8ATLwZx74/T2r5kkLYLIT7V+oX/B2v4T0vwZ/wUU8D6L4fskgg/wCFGaW6xoMAf8TnWh/QV+X9qVbhzxXRfl+Q07CQi5l2wxjLMwVR6k11Vv8ACDxdDZjUr6zjiR4i6ySSYGB7nv7Vl+EoYH8Swm9H+jod5bHQg5FdRrfjjXPFV2mj6xr03kGVY4LYsCsQJ7fTNYzqvc6YRUpWE+DXw8m8QeIJr/UpWEEEL528jftyBU/xI1iawgW0C5dTsCZ/hJ5r17wt4MtfC3gCbRvD9tcfaHAkuL+dNrSFQfucYZSOp5rwjx1dTXPiLzbiQuqSfOT9a8ajXeKxT7I96rhfquEV+p+nP/BGrxf4t8BfBqCz8HeB4tSuLu9ubu8utQn8i1jiAVYozLnAPDYGOCa/QvwB+3/o/g7WLfR/ij8JNT0yaYgfb9Ju4ryzU5xzICvfofrXxF+xV+zJ8R/iR+wloLfBDxkNE1S7sFuWkK8ThpHlK5HIbOAD2Ir3j4BfskftVaN40v4tf+N2t6r4dh0+JLTSdeeN/tMh3earkx9MHG7IPpXzNf2dXG1O59zhVVoYOlzH6IeFPinoHiXSU1uxvGaGVdyFlwcc9fSvMPjZ+3v4B8A6v/wg2mfD7xDr+pB9jjSrXKKc459eo54FN+Gvh9vBvw98Q6TOyzSWGUs5Mgkjyye3fNeMfHf9mr4x61pOo3/wv8XXVlcT6U8tnqVvLGss11hcK4bAC8tyOflHrXPTxFWvL2Z01cNCF53Ol8dftFXV74bl1zXvg7rWmwOMtKLu1kKDn/lispkB+tfnj+374MPjr4gaTrcEBbfZSliR3L17b8EP2dv+ChOieJrSH4hfEA61ootn/tOW9ulWQt22qO2M+v1qr+0vo3h/SfF1vpeoSlBBE6xAL23fWudSpYTFO7NYUvrVMo/8FDvhrYeK/hNJqsOmrJfQXcJRiOdu4k18LaJ8C/Evi/x1pEnhmzR7q5iAuTI+0YD8DP8AwI/nX6UftX2N5cfCnUUglaOZRwV6gYavPv8Agnz+yNceP/CKeJ/FGpXBuruDzNPDRqQ8ZGCcn/awPxr28FifZULo+fxWAWPxmp9S/wDBJv8AZr8YeA7yTXPE9pBGLdTHCY5gxwU/Tmv0W0yIrDg8V87/ALDXgyPwd4OuvC8cwdrG4SJ8Y+U7Se1fRsEnluI84zX3GW1atbCc8z89znCUcLmHJT6H85n/AAeESGL/AIKXeAgDyfgNpg/8rWt1+UsS7ecnrX6q/wDB4U5f/gpn4Gz2+BOmAf8Ag51uvyo3sqnmqSZy043aRPHqNzaviI/rV/w7cW914ls7nVhmNblDJxngMDWXbw3F3L5duhZj0ArqPBfw61bUIbvXNSYxQWj7XVzgkkZ4B6isqsVynVS5vbnvniX4v3N3oF34e8C2YsbOM7Wuo8q0wwecHg9ccV4pPYaddeIrK11S4IiusG6cj7rbsZ/Kt3wfq2seJrB9H0aF5Y7chIhg9MZrUl/Z98X6hbnXtTCww7grRvIA3Psea8CPscNUd9D6DEe1xVKy6H7Gf8EMPHumar+zrodrBdE2mnvJYw+3lOwPHbsfxr9IfGHin4faZ4fafiS5MZHyJlsnPYGvxa/4I1eIvFPh7wVrXgDwo6/8SfxIh8vzMfLJDvwfqY5M/Uetfd2rfFqz8G31r4W+Kd/f/wBo6xaSGzSzhMkkqcq2Mc5+gr43Ht0sbUhD1P0jBUIYrAUud2se/wDhqTTpvAupasCymSdSQ64YfKeorf8AhV4w8Jat4ej0nVoVZ7dRGrOvf86+YtC1VrPTR4b0L4w6vomkR4FxpWraJK9zIR02S4B6cc9zXSad8c/gn8MNDk0O41HXZrq6cKjX2iXUs0smCFMbDcP061lClUbudNXDxqKpTZ738Wb3RNB0AG0hiTMJBljOcZz71+bP7TtheeNviLNJo+mm9S0Z43kZTwSQe1fUnxF134qS+Hzpk3Nq6bre5ll2yyRjOSy44NfCn7Q3jTxzZ+Nm0r4d/HaPwpNb7v7Tt50ObonBjm47Ebh+FTDBSzGroNYqjlmGVz6k+P8AZW19plzpTn5JQVxjrnI/rXp/7PXg1vhh8N/CGo6fcssOn6HbRzRJjcoZ0mPA57Y/GvHfi1ryXWolVfcIpwzL6kHOK+gNWuLHwb8P5rOfUBaSQ2abLnIGI/L4GTxnbgY9q9Olf2Vzw4Vv9otsdx+xX8XYpPip4k8CT2xJnkhulcqed0bfyAH5mvq4xv5+4+vFfJH/AATb8EP421vWvi/e2qxxtOY7Z+7RbW2dfbn8a+wNqSAsDX6VgoKlgaaZ+SZhi1i8zqVD+b7/AIPCWx/wUw8CEH/mhGmZ/wDB1rdflVGwZCGr9U/+DwoAf8FMPAgH/RCNMz9f7a1qvyrgAKnNN2bJprY1fDBvbTVIruzhVwrDcHbAxnnJr23xi7aj4TtJbTS4oSloTdpbktvbJ5P4V43odzBBp0wlbgxsu31BB4q3pXxP8UwWzxnWZlR1KtEG4IIxXJicPKqz0MNXhTi7lj4e/ETU/BHjmPU/D7t5Ly7XgYlRg4Gfwr6WvviZ4d1fw35mu6oZbqUhoERhIw69cdOfavkOKS4n1fdaDLscgV2P2LWtBsU1Zt0NzPgxsp52ng1y5hgKVZx8jpwOMdN+5sfUX7CH7XVh+zh+0XeWnijUzDoniVkh1KRWz9nuQwWOUDuQGPWv2W8W3Wo/F/4daN4q8H6vsv7RVeyuIZBlXy2CDz69a/m3v9Nu5orjVZLozmVsz+aQPmI/nX7If8EwfjP4u8Bfs0eB9R16e5v9JbTYku/OUlrZi7AKFA+7jJJPSvm8+wlOlRWJ7H2PCuY1K1d0p9D74+Gn7SPx/wBB0t7Dx34Rnv78L5cVzYaelwFJBGDKVBGTjvVK20jxR4m8aJ8T/jQM3GnSl9KsE8s/ZcjrNglhIDnHsa6vwX+0D8IjoC3FtqdmwaPcrPKo3Lg5x83NeQfGz9pPU/Gt5ceBvgLorXtzJkSzzrshtj/dzk54OcYrw54+9K6R9Z7al7Zqnh9TB/bJ/af0vwppMj6XI811FYv9mgt1LkK2cFgvKgnHNfjZb/tq+NfAXxM8Y/EDXfAWka/eeJtYEey/vXAs4LQGOJEK9VIcnn0r9UPif8C7zwb4Q1jxP4j15dU1y6s2865uIkhZUQMVgjVT/qxgflX4ffHjw9r3hfxzNZfZPLyzHAJ9a9LhetSdSaW58txRSxio00ftp8VLr+y2udV24WO9SRj/AHkByR+OK8+8Tftc/FD44araeHvEFqtpZsRHNa2crOJQW6kEehxxXX/GC9k1XS7iytDuYoXx7AHNYn7DHwL1L4k/FO1vjYeZHDKDuxnHINenkuEpVqup4XEGPrYVq3U/WP8AYq8Dx/Dz4DabpCAK81ujTBf7w3CvW7b5YzWF4A0FPDnhWy0hF2+TCFxj3Nb+0gYr7VnxMkoxv1Z/N9/weEoW/wCCmXgUHv8AAnTMf+DrW6/K2OMJGa/VX/g8Kf8A42YeAiD934D6WD9f7a1uvyrM4SPLnqeMVlZ8xpBvlQ5bpfLMBPU1C0WH2rmpdKtJL3UVihtJJXZwqxhCSxJ4AAr2/wCGX7Av7SnxfuYrvw38Obu0tJSMXF/G0EYz0BLCsMRisPg1z1Klj0MFlmaY+ryYak53PHvC729vrEU0rHOcV6v4z0XXfENxo2haNZvPcvYwNAkYJLmVm+Xj0+X8TX0LpH/BHPXfBHh278efGLx3FpzWds8gt7V0ljLhSQMjJ6jrXuX/AATw/ZYFukHxc8RQCdoIfJ0zzgBmGRclvbkV8vmfEmApU/bUZXP0HI+BM1r1VRxlP2Z4v8Hf+Cbes+HfAreNfjTYGSa6KS2ehmPcGYg7fMHDLzj6A1+g37Cfw6XQvhZp/wAPtYgWJo7PZKi8/MAf8a7fSfhRe+L/ADr7T7RJ47KQRIrN7A4rrvgr8PNW03x8Y7jSfJU7twUHAbAxXx1TNMVmVG9TY+wqZXl2SYz2dO1zo/DX7Ofw6khW31vwVaXTxEBZpkO79DXf+F/hf4d8Mf8AIC0yO2iHSOJcAV22k+E7nIFzDg1sf2DbQhodmSAcDHeuNUmndnDUrJqyPm39pLwnd+I7N9MSLcjNtx7E/wD16/NP9sj9izwnq/xDgbQ7PfNHC4vx5YG2Td0/Kv1v+Mup+HvCelTajdSpJqHIt7EkfM5zgnByBnHPavjzx+nh7Q9YJ8QFJLy5Z5bi5flpnLZLHnqSa0wuK+q1Wunke/hMkpZrSXtXYm+DmhR/E3Q7vxlrdsbO11GVfsDTKVENu/yknd90ZPevu39in9jm0+CUcOs28kMsdzDvhniYEMCMA5HrX51/8FDNVbwR+xt4i03RblbeJ7S2trSBHA+9dR4QD6Bj9AT2r27/AIN9f+CnM3xU8MWv7GHxx8XW83iDw/b+b4R1K+cRG/08gRiKY4wWjYMVx2AzxX6bw9S/dVKiPxLi5SdanA/UVYnA3EdKc74OeakeREVAHBVxkYOajlaEttQ5zX0EXdnx8ZSqbn83v/B4Kxl/4KXeCAP+iF6X/wCnnWq/Mj4XfDTxR8WvHFj4J8J2xuL2+m2Qx54GBksTzgADrX6c/wDB4CAn/BTLwMEzz8CNM3fX+2daryD/AIIj/Ae38QeN9W+MerWuU06IWmnyEZBkdSXGe3ykfpXl5tjVl+EnXPqeHMs/tXMqeHXU+sf2Sf8AgmB8Ifgx4YtdZ8SeHLfVNbSIST6lcwAvFIAeEIOCDwc19EeG30iPRJXgiMc9s6rcBlx2ycevFeiaVpq/8I7DEybSI/nX35ry/wCJGga7HqbDSb10jll2uqkfdJwf0r8RxOOxuNxDq1Gf1BlmV4XL6CpUOh5x8eNFuvjWf+Fa+HXAtLo5vpi2P3YOGHPBypNek+C/COmeEbO08K6Fp8dvplhYmKBYugCjCDHt0qbwz4K07wpbSPDaQyyTD/XSNh+mOla8Mf2XR2SPrj+hrllUl7K1z0eV+1527npX7LPnpaXLSaYz2z6jIzTKhJ3+XHkflt/M17r4W0Lw82tT6hKxSRpcp5iY7e9edfst61Y2PwpZLRJnm/tVjcbIiQCY4vSvR7xLvVmNxa6Y554d0IxX1GBVOnh031PynO3WrY+ozukhssiRrmMgtgYcHrXDfHHx6fCFt9j8O28b3+0/fcrzn1FW40m0LQ5NT1TCLChYMD/EASK8P8SeL9R8ba7NrV3ICBJhDuzwajHV40oK24siyqtiJ3bOD8V6L4o8Va7L448W6q4uzu2QbwyRg9QD+FfKP7VmpaxN41t4rK+tlMcTiQSXIXnd29a+w/GF8biGSyLZDdq8yufCmgWd7NLc+Gba4kmfc8kmc5/A148ddWz9MwuFpU6ap9j5f/4LOfECw0rQfDHwm0rUALm+vG1S8iiYExpFuijjPoMyynnnivjHTdb1DwZDpPi/wjrd3peq2VzHPa3NjP5TxyBuGz3HqO9T/Gf4teK/jb8Tr74ieOZmuL29kzEjybhbpnOxT6ZJPPrWFrSedDDB2Uc/XNfuWAw/1SgqZ/J+a46OOxnOz90/+CK3/BXBP2ntMh/Zq/aS8U2cfj2wgY6NrFxNsXV4M4LzHHEnHABPXmv0Shilwtx50ZQruyJAcD3r+R3SfFfiXwnf23iDwxq93pd7ZOGt9Q0+ZkmjIOeCpyORX2T+y7/wXw/bz+Bd1Bpvizxfa+PdAaMxzW3iiBXudh4x533ycZ5J+teh7RR2PBcLJmJ/weBQTD/gpn4FLIQH+Bel9fQ61rQ/xruf+CSfw/8A+EA/ZW8NNcRbJdbv7i/uDjrvwIf/ACHEPzxXy1/wWt/bksv+Cmf7ZHgP4qaF8PrnQryy8AWGg6hp9zfGZZJY9U1CX91x93/SccdTX6I/s7+CrL4ffDrQfBMo2R6XpccCgDvGuB/LNfBccYm2ChS7s/WPDDAyeOni/wCQ9++3wQaZES/JTMn1rifEOoR3OvpHE+YyDuP41FN4kuNUMlhBcEbWwxB6GqDRwWN1snumd89WFflibtsf0BTpJyuupo69DAI0mtmyUYAfTPNPmeJrMRseZBlfpWfLeh5hb7s7mwPrWvHYSzm306O1VrnzFjhDHqSen51iqcvrKQ6/7iDe+h9N/svafongz4UQNNaN5mpCOd2WMkkgEV6HL4r0uH5Bf3CoT/qfK/pXJaB8PPEum+F9GsbPWp7drWz2NCuAo+YmrV1puraVK1/rMccvl9bgyZINfZ0XVp0D8dxkYYjG1Glucr+0r8WtNsfD8PhjRJJvNuSvmI8ZXjdg/pXkUT2+l6SdrYY4I4o8c+KX8e+OZ9WZy1tG7CBj/dPNZupTtcX6WSHMYBHWvnMXWlVq2P0DKMu+r4KCW5GRLqMn2lxmsrWrOT7Wdi8c10EqDTLYpGcAVkzXqTvvZ+frWDex78Yvksj8PmJlvhcZz71eaM3DZ61V02Dzx0rZt7PyecV/Qq7H8XtLm0KN5bmCwbt6VlWcJkXzlGWre1v/AI82U+tU/D9mZYQ4Bq4yigV2WfgN8Mx8Uf23/BNjNbebHpmmJqF0uM48mSZl/wDInl/nX6xziXTrRZZD82K/PD/gnxbpD+3dLv6f8K4mL/X7bHiv0B+LustpXgK41W0c+fEuVx9DX5ZxrVlUzCnSP6G8LsPRo5HVxD3MvwX43uZvE+q2L7yyXfy4BxjbXf28djqMP26UbpgeFI614j+zR4hufF1tNrl4x86ZgZsn1XmvY7eQWs4a1OYx3r4ydP2VZ3P0nCz9tRLqWi3jiSGECWKdcqO3Oa7/AOGmkT+IPipodq8e9f7SgeZSeNolXOfwrh9GvUGpu8R/1zbm+tesfs0SQ3Pxtt7S4b5fsspH1AFbYenzYynY8/MKjp5dU5j6ueymuJBIbyQD+5jivJf2pviIfB/hk+H9JuP9Mu2UGPOMoTgn8jXr2vX0Gm2stzPKYkQH94vr2B9q+LfGni3Vvir8RbzxPqczG1jmZLJWPCR8bQPwAr3swrqlRPz3hjL5YzMva1P4cGVtMSKx0pICcSFeR71HElz54uM4x3Jq5JbwG7DyHmq3ifXtM0XTXkK+YwOAmM5P4V8rZuzP1aDS0RH4qvr27it9NsXXzpsFnD9OcVv+F/B2nWdiYdat47iUY+djn+Vcj4Nj1C7tZ9f1SzjCSzf6IrPzGuBkY7cmtGXxrPaOY1l/WuqlaT1FGM5n4heH/wCH61ut978aKK/oGXxn8Wx3M7W/9Q9P8J/8ew/CiisX8RrT2keo/sF/8nzX3/ZOJf8A0vhr7t+MP/JPrr/rif5GiivzHjD/AJGdM/oLw0/5JeZ57+xv/wAgW7+o/wDQDXt9h/yDjRRXxuJ/jH6JhSx4b/5CCV67+zX/AMl6tf8Ar0m/pRRXThv96gcOcf7lUPqX4wf8k/1T/rm3/oBr430H/kEj/fFFFdOabM+U4V/3ep6suXf/AB8VynjX/j9i/wCvhaKK8dbfd+aPvKeyOln/AOQWn+7/AI1x2t/8fh/GiiuiH8Rndh/jf9dD/9k=\"\n    }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{mock_identity_system_url}}/v1/mock-identity-system/identity",
									"host": [
										"{{mock_identity_system_url}}"
									],
									"path": [
										"v1",
										"mock-identity-system",
										"identity"
									]
								}
							},
							"response": []
						}
					]
				}
			]
		},
		{
			"name": "AuthCode flow with OTP login",
			"item": [
				{
					"name": "Get CSRF token",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var token = pm.cookies.get(\"XSRF-TOKEN\")",
									"pm.environment.set(\"csrf_token\", token);"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/esignet/csrf/token",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"csrf",
								"token"
							]
						}
					},
					"response": []
				},
				{
					"name": "Authorize / OAuthdetails request",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var btoa = require('btoa');",
									"",
									"var token = pm.cookies.get(\"XSRF-TOKEN\")",
									"pm.environment.set(\"csrf_token\", token);",
									"",
									"pm.test(\"Validate transactionId\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.response.transactionId).not.equals(null);",
									"    pm.environment.set(\"transaction_id\", jsonData.response.transactionId);",
									"});",
									"",
									"pm.test(\"Validate auth factors\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.response.authFactors[0].name).to.eql(pm.environment.get(\"expected_amr\"));",
									"});",
									"",
									"pm.test(\"set oauth-details-hash\", function () {",
									"    var jsonData = pm.response.json();",
									"    var sha256Hash = CryptoJS.SHA256(JSON.stringify(jsonData.response));",
									"    var base64Encoded = sha256Hash.toString(CryptoJS.enc.Base64);",
									"    // Remove padding characters",
									"    base64Encoded = base64Encoded.replace(/=+$/, '');",
									"    // Replace '+' with '-' and '/' with '_' to convert to base64 URL encoding",
									"    base64Encoded = base64Encoded.replace(/\\+/g, '-').replace(/\\//g, '_');",
									"    console.log(\"base64Encoded : \" + base64Encoded);",
									"    pm.environment.set(\"oauth_details_key\", jsonData.response.transactionId);",
									"    pm.environment.set(\"oauth_details_hash\", base64Encoded);",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-XSRF-TOKEN",
								"value": "{{csrf_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"requestTime\": \"{{$isoTimestamp}}\",\n    \"request\": {\n        \"clientId\": \"{{client_id}}\",\n        \"scope\": \"{{scope}}\",\n        \"responseType\": \"code\",\n        \"redirectUri\": \"{{redirection_url}}\",\n        \"display\": \"popup\",\n        \"prompt\": \"login\",\n        \"acrValues\": \"mosip:idp:acr:generated-code\",\n        \"claims\": {{claims}},\n        \"nonce\" : \"{{$randomAlphaNumeric}}\",\n        \"state\" : \"{{state}}\",\n        \"claimsLocales\" : \"en\"\n    }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/esignet/authorization/v3/oauth-details",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"authorization",
								"v3",
								"oauth-details"
							]
						}
					},
					"response": []
				},
				{
					"name": "Send OTP",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-XSRF-TOKEN",
								"value": "{{csrf_token}}"
							},
							{
								"key": "oauth-details-key",
								"value": "{{oauth_details_key}}"
							},
							{
								"key": "oauth-details-hash",
								"value": "{{oauth_details_hash}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"requestTime\": \"{{$isoTimestamp}}\",\n    \"request\": {\n        \"transactionId\": \"{{transaction_id}}\",\n        \"individualId\": \"{{individual_id}}\",\n        \"otpChannels\" : [\"email\", \"phone\"],\n        \"captchaToken\" : \"dummy\"\n    }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/esignet/authorization/send-otp",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"authorization",
								"send-otp"
							]
						}
					},
					"response": []
				},
				{
					"name": "Authenticate User V2",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var token = pm.cookies.get(\"XSRF-TOKEN\")",
									"pm.environment.set(\"csrf_token\", token);"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-XSRF-TOKEN",
								"value": "{{csrf_token}}"
							},
							{
								"key": "oauth-details-key",
								"value": "{{oauth_details_key}}"
							},
							{
								"key": "oauth-details-hash",
								"value": "{{oauth_details_hash}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"requestTime\": \"{{$isoTimestamp}}\",\n    \"request\": {\n        \"transactionId\": \"{{transaction_id}}\",\n        \"individualId\": \"{{individual_id}}\",\n        \"challengeList\" : [\n            {\n                \"authFactorType\" : \"OTP\",\n                \"challenge\" : \"111111\",\n                \"format\" : \"alpha-numeric\"\n            }\n        ]\n    }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/esignet/authorization/v3/authenticate",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"authorization",
								"v3",
								"authenticate"
							]
						}
					},
					"response": []
				},
				{
					"name": "Authorization Code",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var token = pm.cookies.get(\"XSRF-TOKEN\")",
									"pm.environment.set(\"csrf_token\", token);",
									"",
									"pm.test(\"Validate code\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.response.code).not.equals(null);",
									"    pm.environment.set(\"code\", jsonData.response.code);",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"protocolProfileBehavior": {
						"followRedirects": false
					},
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-XSRF-TOKEN",
								"value": "{{csrf_token}}"
							},
							{
								"key": "oauth-details-key",
								"value": "{{oauth_details_key}}"
							},
							{
								"key": "oauth-details-hash",
								"value": "{{oauth_details_hash}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"requestTime\": \"{{$isoTimestamp}}\",\n    \"request\": {\n        \"transactionId\": \"{{transaction_id}}\",\n        \"acceptedClaims\": {{accepted_claims}},\n        \"permittedAuthorizeScopes\" : []\n    }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/esignet/authorization/auth-code",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"authorization",
								"auth-code"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Tokens",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"eval(pm.environment.get('pmlib_code'))",
									"",
									"// Set headers for JWT",
									"var header = {\t",
									"\t\"alg\": \"RS256\"",
									"};",
									"",
									"const private_key_jwk = JSON.parse(pm.environment.get(\"client_private_key\"));",
									"",
									"const signed_jwt = pmlib.clientAssertPrivateKey(private_key_jwk, pm.environment.get('client_id'), pm.environment.get('audience'), exp = 60,  \"RS256\");",
									"",
									"pm.collectionVariables.set(\"client_assertion\",signed_jwt);",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Validate Id-token\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.id_token).not.equals(null);",
									"});",
									"",
									"pm.test(\"Validate access-token\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.access_token).not.equals(null);",
									"    pm.environment.set(\"access_token\", jsonData.access_token);",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-XSRF-TOKEN",
								"value": "{{csrf_token}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "code",
									"value": "{{code}}",
									"type": "text"
								},
								{
									"key": "client_id",
									"value": "{{client_id}}",
									"type": "text"
								},
								{
									"key": "redirect_uri",
									"value": "{{redirection_url}}",
									"type": "text"
								},
								{
									"key": "grant_type",
									"value": "authorization_code",
									"type": "text"
								},
								{
									"key": "client_assertion_type",
									"value": "urn:ietf:params:oauth:client-assertion-type:jwt-bearer",
									"type": "text"
								},
								{
									"key": "client_assertion",
									"value": "{{client_assertion}}",
									"type": "text"
								}
							]
						},
						"url": {
							"raw": "{{url}}/v1/esignet/oauth/v2/token",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"oauth",
								"v2",
								"token"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get UserInfo",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{access_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{url}}/v1/esignet/oidc/userinfo",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"oidc",
								"userinfo"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "AuthCode Flow with Wallet login",
			"item": [
				{
					"name": "Get CSRF token",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var token = pm.cookies.get(\"XSRF-TOKEN\")",
									"pm.environment.set(\"csrf_token\", token);"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/esignet/csrf/token",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"csrf",
								"token"
							]
						}
					},
					"response": []
				},
				{
					"name": "Send Binding OTP",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Validate transactionId\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.response.transactionId).not.equals(null);",
									"    pm.environment.set(\"binding_transaction_id\", jsonData.response.transactionId);",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-XSRF-TOKEN",
								"value": "{{csrf_token}}"
							},
							{
								"key": "PARTNER-ID",
								"value": "{{relying_party_id}}"
							},
							{
								"key": "PARTNER-API-KEY",
								"value": "{{partner_api_key}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"requestTime\": \"{{$isoTimestamp}}\",\n    \"request\": {\n        \"individualId\" : \"{{individual_id}}\",\n        \"otpChannels\" : [\"email\"]\n    }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/esignet/binding/binding-otp",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"binding",
								"binding-otp"
							]
						}
					},
					"response": []
				},
				{
					"name": "Wallet binding",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = JSON.parse(responseBody);",
									"var cert = JSON.stringify(jsonData.response.certificate);",
									"console.log(cert);",
									"pm.environment.set(\"bind_certificate\",cert);"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"eval(pm.environment.get('pmlib_code'))",
									"keyPair = pmlib.rs.KEYUTIL.generateKeypair(\"RSA\", 2048);",
									"jwkPrivateKey = pmlib.rs.KEYUTIL.getJWK(keyPair.prvKeyObj);",
									"jwkPublicKey  = pmlib.rs.KEYUTIL.getJWK(keyPair.pubKeyObj, nokid = true);",
									"jwkPublicKey[\"alg\"] = \"RS256\";",
									"jwkPublicKey[\"use\"] = \"sig\";",
									"",
									"pm.environment.set(\"binding_public_key\", JSON.stringify(jwkPublicKey))",
									"pm.environment.set(\"binding_private_key\", JSON.stringify(jwkPrivateKey));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "PARTNER-ID",
								"value": "{{relying_party_id}}"
							},
							{
								"key": "PARTNER-API-KEY",
								"value": "{{partner_api_key}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"requestTime\": \"{{$isoTimestamp}}\",\n    \"request\": {\n        \"individualId\": \"{{individual_id}}\",\n        \"challengeList\": [\n            {\n                \"authFactorType\": \"OTP\",\n                \"challenge\": \"111111\",\n                \"format\": \"alpha-numeric\"\n            }\n        ],\n        \"publicKey\": {{binding_public_key}},\n        \"authFactorType\": \"WLA\",\n        \"format\": \"jwt\"\n    }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/esignet/binding/wallet-binding",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"binding",
								"wallet-binding"
							]
						}
					},
					"response": []
				},
				{
					"name": "Authorize / OAuthdetails request",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var btoa = require('btoa');",
									"",
									"var token = pm.cookies.get(\"XSRF-TOKEN\")",
									"pm.environment.set(\"csrf_token\", token);",
									"",
									"pm.test(\"Validate transactionId\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.response.transactionId).not.equals(null);",
									"    pm.environment.set(\"transaction_id\", jsonData.response.transactionId);",
									"});",
									"",
									"pm.test(\"Validate auth factors\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.response.authFactors[0].name).to.eql(pm.environment.get(\"expected_amr\"));",
									"});",
									"",
									"pm.test(\"set oauth-details-hash\", function () {",
									"    var jsonData = pm.response.json();",
									"    var sha256Hash = CryptoJS.SHA256(JSON.stringify(jsonData.response));",
									"    var base64Encoded = sha256Hash.toString(CryptoJS.enc.Base64);",
									"    // Remove padding characters",
									"    base64Encoded = base64Encoded.replace(/=+$/, '');",
									"    // Replace '+' with '-' and '/' with '_' to convert to base64 URL encoding",
									"    base64Encoded = base64Encoded.replace(/\\+/g, '-').replace(/\\//g, '_');",
									"    console.log(\"base64Encoded : \" + base64Encoded);",
									"    pm.environment.set(\"oauth_details_key\", jsonData.response.transactionId);",
									"    pm.environment.set(\"oauth_details_hash\", base64Encoded);",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-XSRF-TOKEN",
								"value": "{{csrf_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"requestTime\": \"{{$isoTimestamp}}\",\n    \"request\": {\n        \"clientId\": \"{{client_id}}\",\n        \"scope\": \"{{scope}}\",\n        \"responseType\": \"code\",\n        \"redirectUri\": \"{{redirection_url}}\",\n        \"display\": \"popup\",\n        \"prompt\": \"login\",\n        \"acrValues\": \"mosip:idp:acr:linked-wallet\",\n        \"claims\": {{claims}},\n        \"nonce\" : \"{{$randomAlphaNumeric}}\",\n        \"state\" : \"{{state}}\",\n        \"claimsLocales\" : \"en\"\n    }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/esignet/authorization/v3/oauth-details",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"authorization",
								"v3",
								"oauth-details"
							]
						}
					},
					"response": []
				},
				{
					"name": "Generate Link code",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Validate linkCode\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.response.linkCode).not.equals(null);",
									"    pm.environment.set(\"link_code\", jsonData.response.linkCode);",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-XSRF-TOKEN",
								"value": "{{csrf_token}}"
							},
							{
								"key": "oauth_details_key",
								"value": "{{oauth_details_key}}"
							},
							{
								"key": "oauth_details_hash",
								"value": "{{oauth_details_hash}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"requestTime\": \"{{$isoTimestamp}}\",\n    \"request\": {\n        \"transactionId\": \"{{transaction_id}}\"\n    }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/esignet/linked-authorization/link-code",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"linked-authorization",
								"link-code"
							]
						}
					},
					"response": []
				},
				{
					"name": "Link transaction (wallet)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Validate linkTransactionId\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.response.linkTransactionId).not.equals(null);",
									"    pm.environment.set(\"link_transaction_id\", jsonData.response.linkTransactionId);",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-XSRF-TOKEN",
								"value": "{{csrf_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"requestTime\": \"{{$isoTimestamp}}\",\n    \"request\": {\n        \"linkCode\": \"{{link_code}}\"\n    }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/esignet/linked-authorization/link-transaction",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"linked-authorization",
								"link-transaction"
							]
						}
					},
					"response": []
				},
				{
					"name": "Link status",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-XSRF-TOKEN",
								"value": "{{csrf_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"requestTime\": \"{{$isoTimestamp}}\",\n    \"request\": {\n        \"transactionId\": \"{{transaction_id}}\",\n        \"linkCode\": \"{{link_code}}\"\n    }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/esignet/linked-authorization/link-status",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"linked-authorization",
								"link-status"
							]
						}
					},
					"response": []
				},
				{
					"name": "Link Authenticate User (wallet) -V2",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"eval(pm.environment.get('pmlib_code'))",
									"",
									"//sign token",
									"const private_key_jwk = JSON.parse(pm.environment.get(\"binding_private_key\"));",
									"var certificate = eval(pm.environment.get('bind_certificate'));",
									"var public_key_jwk = pmlib.rs.KEYUTIL.getJWK(certificate);",
									"",
									"// Set headers for JWT",
									"var header = {",
									"    \"x5t#S256\" : public_key_jwk['x5t#S256'],",
									"\t\"alg\": \"RS256\"",
									"};",
									"",
									"const signed_jwt = pmlib.jwtSign(private_key_jwk, {",
									"    \"aud\" : pm.environment.get('wla_audience'),",
									"\t\"sub\": pm.environment.get('individual_id'),",
									"    \"iss\" : \"postman-inji\"",
									"}, header, exp=600, alg = \"RS256\")",
									"",
									"pm.collectionVariables.set(\"wla_challenge\",signed_jwt);",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-XSRF-TOKEN",
								"value": "{{csrf_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"requestTime\": \"{{$isoTimestamp}}\",\n    \"request\": {\n        \"linkedTransactionId\": \"{{link_transaction_id}}\",\n        \"individualId\": \"{{individual_id}}\",\n        \"challengeList\" : [\n            {\n                \"authFactorType\" : \"WLA\",\n                \"challenge\" : \"{{wla_challenge}}\",\n                \"format\" : \"jwt\"\n            }\n        ]\n    }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/esignet/linked-authorization/v2/authenticate",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"linked-authorization",
								"v2",
								"authenticate"
							]
						}
					},
					"response": []
				},
				{
					"name": "Link Consent Request (wallet)",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"eval(pm.environment.get('pmlib_code'));",
									"",
									"const private_key_jwk = JSON.parse(pm.environment.get(\"binding_private_key\"));",
									"var certificate = eval(pm.environment.get('bind_certificate'));",
									"var public_key_jwk = pmlib.rs.KEYUTIL.getJWK(certificate);",
									"",
									"// Set headers for JWT",
									"var header = {",
									"    \"x5t#S256\" : public_key_jwk['x5t#S256'],",
									"\t\"alg\": \"RS256\"",
									"};",
									"var payload = {}",
									"var acceptedClaims = pm.environment.get('accepted_claims');",
									"if(acceptedClaims != undefined && Array.isArray(acceptedClaims)){",
									"    payload[\"acceptedClaims\"] = acceptedClaims.sort()",
									"}",
									"var permittedAuthorizedScopes = eval(pm.environment.get('permitted_authorized_scopes'));",
									"if(permittedAuthorizedScopes != undefined && Array.isArray(permittedAuthorizedScopes)){",
									"    payload[\"permittedAuthorizedScopes\"] = permittedAuthorizedScopes.sort()",
									"}",
									"const signedPayload = pmlib.rs.jws.JWS.sign(",
									"    null, header, payload, private_key_jwk",
									");",
									"var parts = signedPayload.split(\".\");",
									"var detachedSignature = parts[0] + \".\" + parts[2];",
									"pm.environment.set(\"detachedSignature\",  detachedSignature);"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Validate code\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.response.code).not.equals(null);",
									"    pm.collectionVariables.set(\"code\", jsonData.response.code);",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"protocolProfileBehavior": {
						"followRedirects": false
					},
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-XSRF-TOKEN",
								"value": "{{csrf_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"requestTime\": \"{{$isoTimestamp}}\",\n    \"request\": {\n        \"linkedTransactionId\": \"{{link_transaction_id}}\",\n        \"acceptedClaims\": {{accepted_claims}},\n        \"signature\": \"{{detachedSignature}}\"\n    }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/esignet/linked-authorization/v2/consent",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"linked-authorization",
								"v2",
								"consent"
							]
						}
					},
					"response": []
				},
				{
					"name": "Link auth code request",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Validate code\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.response.code).not.equals(null);",
									"    pm.environment.set(\"code\", jsonData.response.code);",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-XSRF-TOKEN",
								"value": "{{csrf_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"requestTime\": \"{{$isoTimestamp}}\",\n    \"request\": {\n        \"transactionId\": \"{{transaction_id}}\",\n        \"linkedCode\": \"{{link_code}}\"\n    }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/esignet/linked-authorization/link-auth-code",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"linked-authorization",
								"link-auth-code"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Tokens",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"eval(pm.environment.get('pmlib_code'))",
									"",
									"// Set headers for JWT",
									"var header = {\t",
									"\t\"alg\": \"RS256\"",
									"};",
									"",
									"const private_key_jwk = JSON.parse(pm.environment.get(\"client_private_key\"));",
									"",
									"const signed_jwt = pmlib.clientAssertPrivateKey(private_key_jwk, pm.environment.get('client_id'), pm.environment.get('audience'), exp = 60,  \"RS256\");",
									"",
									"pm.collectionVariables.set(\"client_assertion\",signed_jwt);",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Validate Id-token\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.id_token).not.equals(null);",
									"});",
									"",
									"pm.test(\"Validate access-token\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.access_token).not.equals(null);",
									"    pm.environment.set(\"access_token\", jsonData.access_token);",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "code",
									"value": "{{code}}",
									"type": "text"
								},
								{
									"key": "client_id",
									"value": "{{client_id}}",
									"type": "text"
								},
								{
									"key": "redirect_uri",
									"value": "{{redirection_url}}",
									"type": "text"
								},
								{
									"key": "grant_type",
									"value": "authorization_code",
									"type": "text"
								},
								{
									"key": "client_assertion_type",
									"value": "urn:ietf:params:oauth:client-assertion-type:jwt-bearer",
									"type": "text"
								},
								{
									"key": "client_assertion",
									"value": "{{client_assertion}}",
									"type": "text"
								}
							]
						},
						"url": {
							"raw": "{{url}}/v1/esignet/oauth/v2/token",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"oauth",
								"v2",
								"token"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get UserInfo",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{access_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{url}}/v1/esignet/oidc/userinfo",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"oidc",
								"userinfo"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "AuthCode Flow with Verified Claims",
			"item": [
				{
					"name": "Get CSRF token",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var token = pm.cookies.get(\"XSRF-TOKEN\")",
									"pm.environment.set(\"csrf_token\", token);"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/esignet/csrf/token",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"csrf",
								"token"
							]
						}
					},
					"response": []
				},
				{
					"name": "Authorize / OAuthdetails request",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var btoa = require('btoa');",
									"",
									"var token = pm.cookies.get(\"XSRF-TOKEN\")",
									"pm.environment.set(\"csrf_token\", token);",
									"",
									"pm.test(\"Validate transactionId\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.response.transactionId).not.equals(null);",
									"    pm.environment.set(\"transaction_id\", jsonData.response.transactionId);",
									"});",
									"",
									"pm.test(\"Validate auth factors\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.response.authFactors[0].name).to.eql(pm.environment.get(\"expected_amr\"));",
									"});",
									"",
									"pm.test(\"set oauth-details-hash\", function () {",
									"    var jsonData = pm.response.json();",
									"    var sha256Hash = CryptoJS.SHA256(JSON.stringify(jsonData.response));",
									"    var base64Encoded = sha256Hash.toString(CryptoJS.enc.Base64);",
									"    // Remove padding characters",
									"    base64Encoded = base64Encoded.replace(/=+$/, '');",
									"    // Replace '+' with '-' and '/' with '_' to convert to base64 URL encoding",
									"    base64Encoded = base64Encoded.replace(/\\+/g, '-').replace(/\\//g, '_');",
									"    console.log(\"base64Encoded : \" + base64Encoded);",
									"    pm.environment.set(\"oauth_details_key\", jsonData.response.transactionId);",
									"    pm.environment.set(\"oauth_details_hash\", base64Encoded);",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-XSRF-TOKEN",
								"value": "{{csrf_token}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"requestTime\": \"{{$isoTimestamp}}\",\n    \"request\": {\n        \"clientId\": \"{{client_id}}\",\n        \"scope\": \"{{scope}}\",\n        \"responseType\": \"code\",\n        \"redirectUri\": \"{{redirection_url}}\",\n        \"display\": \"popup\",\n        \"prompt\": \"login\",\n        \"acrValues\": \"mosip:idp:acr:generated-code\",\n        \"claims\": {{claims_v3}},\n        \"nonce\" : \"{{$randomAlphaNumeric}}\",\n        \"state\" : \"{{state}}\",\n        \"claimsLocales\" : \"en\"\n    }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/esignet/authorization/v3/oauth-details",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"authorization",
								"v3",
								"oauth-details"
							]
						}
					},
					"response": []
				},
				{
					"name": "Send OTP",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-XSRF-TOKEN",
								"value": "{{csrf_token}}"
							},
							{
								"key": "oauth-details-key",
								"value": "{{oauth_details_key}}"
							},
							{
								"key": "oauth-details-hash",
								"value": "{{oauth_details_hash}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"requestTime\": \"{{$isoTimestamp}}\",\n    \"request\": {\n        \"transactionId\": \"{{transaction_id}}\",\n        \"individualId\": \"{{individual_id}}\",\n        \"otpChannels\" : [\"email\", \"phone\"],\n        \"captchaToken\" : \"dummy\"\n    }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/esignet/authorization/send-otp",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"authorization",
								"send-otp"
							]
						}
					},
					"response": []
				},
				{
					"name": "Authenticate User",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var token = pm.cookies.get(\"XSRF-TOKEN\")",
									"pm.environment.set(\"csrf_token\", token);"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-XSRF-TOKEN",
								"value": "{{csrf_token}}"
							},
							{
								"key": "oauth-details-key",
								"value": "{{oauth_details_key}}"
							},
							{
								"key": "oauth-details-hash",
								"value": "{{oauth_details_hash}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"requestTime\": \"{{$isoTimestamp}}\",\n    \"request\": {\n        \"transactionId\": \"{{transaction_id}}\",\n        \"individualId\": \"{{individual_id}}\",\n        \"challengeList\" : [\n            {\n                \"authFactorType\" : \"OTP\",\n                \"challenge\" : \"111111\",\n                \"format\" : \"alpha-numeric\"\n            }\n        ]\n    }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/esignet/authorization/v3/authenticate",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"authorization",
								"v3",
								"authenticate"
							]
						}
					},
					"response": []
				},
				{
					"name": "Claim Details",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-XSRF-TOKEN",
								"value": "{{csrf_token}}",
								"type": "text"
							},
							{
								"key": "oauth-details-key",
								"value": "{{oauth_details_key}}",
								"type": "text"
							},
							{
								"key": "oauth-details-hash",
								"value": "{{oauth_details_hash}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/esignet/authorization/claim-details",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"authorization",
								"claim-details"
							]
						}
					},
					"response": []
				},
				{
					"name": "Prepare Signup Redirect",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = pm.response.json();",
									"var id_token = jsonData.response.idToken;",
									"pm.expect(id_token).not.equals(null);",
									"",
									"//Use id_token_hint to start new OIDC flow",
									"pm.globals.set(\"id_token_hint\", id_token); "
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-XSRF-TOKEN",
								"value": "{{csrf_token}}"
							},
							{
								"key": "oauth-details-key",
								"value": "{{oauth_details_key}}"
							},
							{
								"key": "oauth-details-hash",
								"value": "{{oauth_details_hash}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"requestTime\": \"{{$isoTimestamp}}\",\n    \"request\": {\n        \"transactionId\": \"{{transaction_id}}\",\n        \"pathFragment\": \"path-fragment\"\n    }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/esignet/authorization/prepare-signup-redirect",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"authorization",
								"prepare-signup-redirect"
							]
						}
					},
					"response": []
				},
				{
					"name": "Complete Signup Redirect",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-XSRF-TOKEN",
								"value": "{{csrf_token}}",
								"type": "text"
							},
							{
								"key": "oauth-details-key",
								"value": "{{oauth_details_key}}",
								"type": "text"
							},
							{
								"key": "oauth-details-hash",
								"value": "{{oauth_details_hash}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"requestTime\": \"{{$isoTimestamp}}\",\r\n    \"request\": {\r\n        \"transactionId\": \"{{transaction_id}}\"\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/esignet/authorization/complete-signup-redirect",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"authorization",
								"complete-signup-redirect"
							]
						}
					},
					"response": []
				},
				{
					"name": "Authorization Code",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var token = pm.cookies.get(\"XSRF-TOKEN\")",
									"pm.environment.set(\"csrf_token\", token);",
									"",
									"pm.test(\"Validate code\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.response.code).not.equals(null);",
									"    pm.environment.set(\"code\", jsonData.response.code);",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"protocolProfileBehavior": {
						"followRedirects": false
					},
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-XSRF-TOKEN",
								"value": "{{csrf_token}}"
							},
							{
								"key": "oauth-details-key",
								"value": "{{oauth_details_key}}"
							},
							{
								"key": "oauth-details-hash",
								"value": "{{oauth_details_hash}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"requestTime\": \"{{$isoTimestamp}}\",\n    \"request\": {\n        \"transactionId\": \"{{transaction_id}}\",\n        \"acceptedClaims\": [\"name\",\"phone_number\"],\n        \"permittedAuthorizeScopes\" : {{permitted_authorized_scopes}}\n    }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/esignet/authorization/auth-code",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"authorization",
								"auth-code"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Tokens",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"eval(pm.environment.get('pmlib_code'))",
									"",
									"// Set headers for JWT",
									"var header = {\t",
									"\t\"alg\": \"RS256\"",
									"};",
									"",
									"",
									"//sign token",
									"//Note: Key pair is generated in \"Create OIDC client\" pre-requests script",
									"//generated private and public keys are stored in the postman environment ",
									"const signed_jwt = pmlib.clientAssertPrivateKey(JSON.parse(pm.environment.get(\"client_private_key\")), pm.environment.get('client_id'), pm.environment.get('audience'), exp = 60,  \"RS256\");",
									"",
									"pm.collectionVariables.set(\"client_assertion\",signed_jwt);",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Validate Id-token\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.id_token).not.equals(null);",
									"});",
									"",
									"pm.test(\"Validate access-token\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.access_token).not.equals(null);",
									"    pm.environment.set(\"access_token\", jsonData.access_token);",
									"});"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "code",
									"value": "{{code}}",
									"type": "text"
								},
								{
									"key": "client_id",
									"value": "{{client_id}}",
									"type": "text"
								},
								{
									"key": "redirect_uri",
									"value": "{{redirection_url}}",
									"type": "text"
								},
								{
									"key": "grant_type",
									"value": "authorization_code",
									"type": "text"
								},
								{
									"key": "client_assertion_type",
									"value": "urn:ietf:params:oauth:client-assertion-type:jwt-bearer",
									"type": "text"
								},
								{
									"key": "client_assertion",
									"value": "{{client_assertion}}",
									"type": "text"
								},
								{
									"key": "code_verifier",
									"value": "dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk",
									"type": "text"
								}
							]
						},
						"url": {
							"raw": "{{url}}/v1/esignet/oauth/v2/token",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"oauth",
								"v2",
								"token"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get UserInfo",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{access_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{url}}/v1/esignet/oidc/userinfo",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"oidc",
								"userinfo"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Well-known endpoints",
			"item": [
				{
					"name": "JWKS",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{url}}/v1/esignet/oauth/.well-known/jwks.json",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"oauth",
								".well-known",
								"jwks.json"
							]
						}
					},
					"response": []
				},
				{
					"name": "Openid-configuration",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{url}}/v1/esignet/oidc/.well-known/openid-configuration",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"oidc",
								".well-known",
								"openid-configuration"
							]
						}
					},
					"response": []
				},
				{
					"name": "OAuth-configuration",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{url}}/v1/esignet/oauth/.well-known/oauth-authorization-server",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"esignet",
								"oauth",
								".well-known",
								"oauth-authorization-server"
							]
						}
					},
					"response": []
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "clientId",
			"value": "mock-oidc-client"
		},
		{
			"key": "redirectionUrl",
			"value": "https://mosip.io/index.php"
		},
		{
			"key": "relayingPartyId",
			"value": "mock-relaying-party-id"
		},
		{
			"key": "status",
			"value": "\"ACTIVE\""
		},
		{
			"key": "acr_values",
			"value": "level0 level1"
		},
		{
			"key": "scope",
			"value": "openid profile"
		},
		{
			"key": "claims_request_param",
			"value": "{\n            \"userinfo\": {\n                \"email\": {\n                    \"value\": null,\n                    \"values\": null,\n           ..."
		},
		{
			"key": "nonce",
			"value": "2erwER34WW"
		},
		{
			"key": "state",
			"value": "ptOO76SD"
		},
		{
			"key": "expected_amr",
			"value": "\"pin\""
		},
		{
			"key": "transaction_id",
			"value": "ece56bfa-d0c2-46ce-a5a2-8500dfb393a7"
		},
		{
			"key": "individual_id",
			"value": "8267411571"
		},
		{
			"key": "auth_pin",
			"value": "34789"
		},
		{
			"key": "url",
			"value": "http://localhost:8088/v1/idp"
		},
		{
			"key": "url",
			"value": "",
			"disabled": true
		},
		{
			"key": "code",
			"value": ""
		},
		{
			"key": "client_assertion",
			"value": ""
		},
		{
			"key": "access_token",
			"value": ""
		},
		{
			"key": "linkTransactionId",
			"value": ""
		},
		{
			"key": "wla_challenge",
			"value": ""
		},
		{
			"key": "client_secret",
			"value": "JfoG3eLWLW7iSZDt"
		},
		{
			"key": "client_secret",
			"value": ""
		},
		{
			"key": "csrf_token",
			"value": "08a17840-da3c-4b93-9ab3-83d9b297ac68",
			"type": "string"
		}
	]
}